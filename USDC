{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "3047f9bb",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt\n",
    "import re\n",
    "import os\n",
    "import requests\n",
    "from bs4 import BeautifulSoup as bs\n",
    "from random import randint\n",
    "from random import *\n",
    "from time import sleep "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "c9cf21c9",
   "metadata": {},
   "outputs": [],
   "source": [
    "def get_SP500_wikipedia_data():\n",
    "    URL = 'https://etherscan.io/tokentxns?a=0xbcca60bb61934080951369a648fb03df4f96263c&p='\n",
    "    frames=[]\n",
    "    for page in range(1,197):\n",
    "        req = requests.get(URL + str(page) + '/')\n",
    "        N_URL=\"URL\",URL + str(page)   #N_URL est de la forme ('URL', 'https://etherscan.io/txs?a=0xcc9a0b7c43dc2a5f023bb9b738e45b0ef6b06e04&ps=100&p=1/')\n",
    "        New_URL=N_URL[1]  ##N_URL est de la forme https://etherscan.io/txs?a=0xcc9a0b7c43dc2a5f023bb9b738e45b0ef6b06e04&ps=100&p=1/\n",
    "        #print(New_URL)\n",
    "        \n",
    "        data_frames = pd.read_html(\n",
    "        io=requests.get(New_URL, headers={'User-agent': 'Mozilla/5.0'}).text)\n",
    "        dff=data_frames[0]\n",
    "        dff.sort_values(by='Txn Hash', ignore_index=True)\n",
    "        \n",
    "        \n",
    "        frames.append(dff) \n",
    "    \n",
    "        result = pd.concat(frames,ignore_index=True)\n",
    "        #print(\"New_URL:\",New_URL)\n",
    "        sleep(random())\n",
    "    #print(frames)\n",
    "\n",
    "    return result"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "c130eec9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>Txn Hash</th>\n",
       "      <th>Unnamed: 2</th>\n",
       "      <th>Unnamed: 3</th>\n",
       "      <th>From</th>\n",
       "      <th>Unnamed: 5</th>\n",
       "      <th>To</th>\n",
       "      <th>Value</th>\n",
       "      <th>Token</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0x2921c93dfdf53dfcd72fe1cb7b6acc1d0fcacb80b42b...</td>\n",
       "      <td>2 mins ago</td>\n",
       "      <td>zeroxignacio.eth</td>\n",
       "      <td>IN</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>163651.588590</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0x88e9c3576be6d803b7fbf95a83a163824202c3f08bcb...</td>\n",
       "      <td>5 mins ago</td>\n",
       "      <td>0xf2f400c138f9fb900576263af0bc7fcde2b1b8a8</td>\n",
       "      <td>IN</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>32475.826065</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0xb1eb11bdc6358b1a41ac07c00fee031cb82425159a3a...</td>\n",
       "      <td>13 mins ago</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>OUT</td>\n",
       "      <td>goldensperm.eth</td>\n",
       "      <td>0.103456</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0xde6d8acf9ddacf5ab1bf9960724af7d4df62001d00f6...</td>\n",
       "      <td>13 mins ago</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>OUT</td>\n",
       "      <td>horizonzerodawn.eth</td>\n",
       "      <td>0.055000</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0x4c7ac11ff4ef6b6d8834ab068890276d2e9dc10f6d46...</td>\n",
       "      <td>15 mins ago</td>\n",
       "      <td>0xeec1e0f055af1f45ac67400b7c706494651c3a53</td>\n",
       "      <td>IN</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>2.488251</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9795</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0x1c1784c72915cad03af2cf1e1c2bdd5f1df88599630c...</td>\n",
       "      <td>28 days 21 hrs ago</td>\n",
       "      <td>0xd3df502ae3e5db05b5dd8a744417a5ad51c11f9b</td>\n",
       "      <td>IN</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>2000.000000</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9796</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0xe8c82b5ff9a493434d74f04722558461f89d057c847b...</td>\n",
       "      <td>28 days 21 hrs ago</td>\n",
       "      <td>MEV Bot: 0x9A0...832</td>\n",
       "      <td>IN</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>169.226442</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9797</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0xd8a523fb06197c2f349c68c312b9910841820da5afbc...</td>\n",
       "      <td>28 days 21 hrs ago</td>\n",
       "      <td>MEV Bot: 0x847...2d2</td>\n",
       "      <td>IN</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>210.153261</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9798</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0xfec853a12b17374a84d5dbcf0d3a6be882ae2cb69106...</td>\n",
       "      <td>28 days 21 hrs ago</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>OUT</td>\n",
       "      <td>0xea7ed1807c1a18bcbef9c20624a3aa05a9f0b50c</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9799</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0xedde5ab0c3d877fee5e705c4e740c13a218e75e586ee...</td>\n",
       "      <td>28 days 21 hrs ago</td>\n",
       "      <td>MEV Bot: 0x9A0...832</td>\n",
       "      <td>IN</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>170.599683</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>9800 rows Ã— 9 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Unnamed: 0                                           Txn Hash  \\\n",
       "0            NaN  0x2921c93dfdf53dfcd72fe1cb7b6acc1d0fcacb80b42b...   \n",
       "1            NaN  0x88e9c3576be6d803b7fbf95a83a163824202c3f08bcb...   \n",
       "2            NaN  0xb1eb11bdc6358b1a41ac07c00fee031cb82425159a3a...   \n",
       "3            NaN  0xde6d8acf9ddacf5ab1bf9960724af7d4df62001d00f6...   \n",
       "4            NaN  0x4c7ac11ff4ef6b6d8834ab068890276d2e9dc10f6d46...   \n",
       "...          ...                                                ...   \n",
       "9795         NaN  0x1c1784c72915cad03af2cf1e1c2bdd5f1df88599630c...   \n",
       "9796         NaN  0xe8c82b5ff9a493434d74f04722558461f89d057c847b...   \n",
       "9797         NaN  0xd8a523fb06197c2f349c68c312b9910841820da5afbc...   \n",
       "9798         NaN  0xfec853a12b17374a84d5dbcf0d3a6be882ae2cb69106...   \n",
       "9799         NaN  0xedde5ab0c3d877fee5e705c4e740c13a218e75e586ee...   \n",
       "\n",
       "              Unnamed: 2                                  Unnamed: 3 From  \\\n",
       "0             2 mins ago                            zeroxignacio.eth   IN   \n",
       "1             5 mins ago  0xf2f400c138f9fb900576263af0bc7fcde2b1b8a8   IN   \n",
       "2            13 mins ago                        Aave: aUSDC Token V2  OUT   \n",
       "3            13 mins ago                        Aave: aUSDC Token V2  OUT   \n",
       "4            15 mins ago  0xeec1e0f055af1f45ac67400b7c706494651c3a53   IN   \n",
       "...                  ...                                         ...  ...   \n",
       "9795  28 days 21 hrs ago  0xd3df502ae3e5db05b5dd8a744417a5ad51c11f9b   IN   \n",
       "9796  28 days 21 hrs ago                        MEV Bot: 0x9A0...832   IN   \n",
       "9797  28 days 21 hrs ago                        MEV Bot: 0x847...2d2   IN   \n",
       "9798  28 days 21 hrs ago                        Aave: aUSDC Token V2  OUT   \n",
       "9799  28 days 21 hrs ago                        MEV Bot: 0x9A0...832   IN   \n",
       "\n",
       "                                      Unnamed: 5             To  \\\n",
       "0                           Aave: aUSDC Token V2  163651.588590   \n",
       "1                           Aave: aUSDC Token V2   32475.826065   \n",
       "2                                goldensperm.eth       0.103456   \n",
       "3                            horizonzerodawn.eth       0.055000   \n",
       "4                           Aave: aUSDC Token V2       2.488251   \n",
       "...                                          ...            ...   \n",
       "9795                        Aave: aUSDC Token V2    2000.000000   \n",
       "9796                        Aave: aUSDC Token V2     169.226442   \n",
       "9797                        Aave: aUSDC Token V2     210.153261   \n",
       "9798  0xea7ed1807c1a18bcbef9c20624a3aa05a9f0b50c       2.000000   \n",
       "9799                        Aave: aUSDC Token V2     170.599683   \n",
       "\n",
       "                Value  Token  \n",
       "0     USD Coin (USDC)    NaN  \n",
       "1     USD Coin (USDC)    NaN  \n",
       "2     USD Coin (USDC)    NaN  \n",
       "3     USD Coin (USDC)    NaN  \n",
       "4     USD Coin (USDC)    NaN  \n",
       "...               ...    ...  \n",
       "9795  USD Coin (USDC)    NaN  \n",
       "9796  USD Coin (USDC)    NaN  \n",
       "9797  USD Coin (USDC)    NaN  \n",
       "9798  USD Coin (USDC)    NaN  \n",
       "9799  USD Coin (USDC)    NaN  \n",
       "\n",
       "[9800 rows x 9 columns]"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df=get_SP500_wikipedia_data()\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "cab3854d",
   "metadata": {},
   "outputs": [],
   "source": [
    "del df['Unnamed: 0']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "a674ec9c",
   "metadata": {},
   "outputs": [],
   "source": [
    "del df['Token']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "9ffd7b01",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Txn Hash</th>\n",
       "      <th>Unnamed: 2</th>\n",
       "      <th>Unnamed: 3</th>\n",
       "      <th>From</th>\n",
       "      <th>Unnamed: 5</th>\n",
       "      <th>To</th>\n",
       "      <th>Value</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0x2921c93dfdf53dfcd72fe1cb7b6acc1d0fcacb80b42b...</td>\n",
       "      <td>2 mins ago</td>\n",
       "      <td>zeroxignacio.eth</td>\n",
       "      <td>IN</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>163651.58859</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                            Txn Hash  Unnamed: 2  \\\n",
       "0  0x2921c93dfdf53dfcd72fe1cb7b6acc1d0fcacb80b42b...  2 mins ago   \n",
       "\n",
       "         Unnamed: 3 From            Unnamed: 5            To            Value  \n",
       "0  zeroxignacio.eth   IN  Aave: aUSDC Token V2  163651.58859  USD Coin (USDC)  "
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.head(1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "93dfbb87",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Txn_Hash</th>\n",
       "      <th>Age</th>\n",
       "      <th>From</th>\n",
       "      <th>IN_or_OUT</th>\n",
       "      <th>To</th>\n",
       "      <th>Value</th>\n",
       "      <th>Token</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0x2921c93dfdf53dfcd72fe1cb7b6acc1d0fcacb80b42b...</td>\n",
       "      <td>2 mins ago</td>\n",
       "      <td>zeroxignacio.eth</td>\n",
       "      <td>IN</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>163651.588590</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0x88e9c3576be6d803b7fbf95a83a163824202c3f08bcb...</td>\n",
       "      <td>5 mins ago</td>\n",
       "      <td>0xf2f400c138f9fb900576263af0bc7fcde2b1b8a8</td>\n",
       "      <td>IN</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>32475.826065</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0xb1eb11bdc6358b1a41ac07c00fee031cb82425159a3a...</td>\n",
       "      <td>13 mins ago</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>OUT</td>\n",
       "      <td>goldensperm.eth</td>\n",
       "      <td>0.103456</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0xde6d8acf9ddacf5ab1bf9960724af7d4df62001d00f6...</td>\n",
       "      <td>13 mins ago</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>OUT</td>\n",
       "      <td>horizonzerodawn.eth</td>\n",
       "      <td>0.055000</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0x4c7ac11ff4ef6b6d8834ab068890276d2e9dc10f6d46...</td>\n",
       "      <td>15 mins ago</td>\n",
       "      <td>0xeec1e0f055af1f45ac67400b7c706494651c3a53</td>\n",
       "      <td>IN</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>2.488251</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9795</th>\n",
       "      <td>0x1c1784c72915cad03af2cf1e1c2bdd5f1df88599630c...</td>\n",
       "      <td>28 days 21 hrs ago</td>\n",
       "      <td>0xd3df502ae3e5db05b5dd8a744417a5ad51c11f9b</td>\n",
       "      <td>IN</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>2000.000000</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9796</th>\n",
       "      <td>0xe8c82b5ff9a493434d74f04722558461f89d057c847b...</td>\n",
       "      <td>28 days 21 hrs ago</td>\n",
       "      <td>MEV Bot: 0x9A0...832</td>\n",
       "      <td>IN</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>169.226442</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9797</th>\n",
       "      <td>0xd8a523fb06197c2f349c68c312b9910841820da5afbc...</td>\n",
       "      <td>28 days 21 hrs ago</td>\n",
       "      <td>MEV Bot: 0x847...2d2</td>\n",
       "      <td>IN</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>210.153261</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9798</th>\n",
       "      <td>0xfec853a12b17374a84d5dbcf0d3a6be882ae2cb69106...</td>\n",
       "      <td>28 days 21 hrs ago</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>OUT</td>\n",
       "      <td>0xea7ed1807c1a18bcbef9c20624a3aa05a9f0b50c</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9799</th>\n",
       "      <td>0xedde5ab0c3d877fee5e705c4e740c13a218e75e586ee...</td>\n",
       "      <td>28 days 21 hrs ago</td>\n",
       "      <td>MEV Bot: 0x9A0...832</td>\n",
       "      <td>IN</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>170.599683</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>9800 rows Ã— 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                               Txn_Hash                 Age  \\\n",
       "0     0x2921c93dfdf53dfcd72fe1cb7b6acc1d0fcacb80b42b...          2 mins ago   \n",
       "1     0x88e9c3576be6d803b7fbf95a83a163824202c3f08bcb...          5 mins ago   \n",
       "2     0xb1eb11bdc6358b1a41ac07c00fee031cb82425159a3a...         13 mins ago   \n",
       "3     0xde6d8acf9ddacf5ab1bf9960724af7d4df62001d00f6...         13 mins ago   \n",
       "4     0x4c7ac11ff4ef6b6d8834ab068890276d2e9dc10f6d46...         15 mins ago   \n",
       "...                                                 ...                 ...   \n",
       "9795  0x1c1784c72915cad03af2cf1e1c2bdd5f1df88599630c...  28 days 21 hrs ago   \n",
       "9796  0xe8c82b5ff9a493434d74f04722558461f89d057c847b...  28 days 21 hrs ago   \n",
       "9797  0xd8a523fb06197c2f349c68c312b9910841820da5afbc...  28 days 21 hrs ago   \n",
       "9798  0xfec853a12b17374a84d5dbcf0d3a6be882ae2cb69106...  28 days 21 hrs ago   \n",
       "9799  0xedde5ab0c3d877fee5e705c4e740c13a218e75e586ee...  28 days 21 hrs ago   \n",
       "\n",
       "                                            From IN_or_OUT  \\\n",
       "0                               zeroxignacio.eth        IN   \n",
       "1     0xf2f400c138f9fb900576263af0bc7fcde2b1b8a8        IN   \n",
       "2                           Aave: aUSDC Token V2       OUT   \n",
       "3                           Aave: aUSDC Token V2       OUT   \n",
       "4     0xeec1e0f055af1f45ac67400b7c706494651c3a53        IN   \n",
       "...                                          ...       ...   \n",
       "9795  0xd3df502ae3e5db05b5dd8a744417a5ad51c11f9b        IN   \n",
       "9796                        MEV Bot: 0x9A0...832        IN   \n",
       "9797                        MEV Bot: 0x847...2d2        IN   \n",
       "9798                        Aave: aUSDC Token V2       OUT   \n",
       "9799                        MEV Bot: 0x9A0...832        IN   \n",
       "\n",
       "                                              To          Value  \\\n",
       "0                           Aave: aUSDC Token V2  163651.588590   \n",
       "1                           Aave: aUSDC Token V2   32475.826065   \n",
       "2                                goldensperm.eth       0.103456   \n",
       "3                            horizonzerodawn.eth       0.055000   \n",
       "4                           Aave: aUSDC Token V2       2.488251   \n",
       "...                                          ...            ...   \n",
       "9795                        Aave: aUSDC Token V2    2000.000000   \n",
       "9796                        Aave: aUSDC Token V2     169.226442   \n",
       "9797                        Aave: aUSDC Token V2     210.153261   \n",
       "9798  0xea7ed1807c1a18bcbef9c20624a3aa05a9f0b50c       2.000000   \n",
       "9799                        Aave: aUSDC Token V2     170.599683   \n",
       "\n",
       "                Token  \n",
       "0     USD Coin (USDC)  \n",
       "1     USD Coin (USDC)  \n",
       "2     USD Coin (USDC)  \n",
       "3     USD Coin (USDC)  \n",
       "4     USD Coin (USDC)  \n",
       "...               ...  \n",
       "9795  USD Coin (USDC)  \n",
       "9796  USD Coin (USDC)  \n",
       "9797  USD Coin (USDC)  \n",
       "9798  USD Coin (USDC)  \n",
       "9799  USD Coin (USDC)  \n",
       "\n",
       "[9800 rows x 7 columns]"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.columns = [\"Txn_Hash\",\"Age\",\"From\",\"IN_or_OUT\",\"To\",\"Value\",\"Token\"]\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "6764107b",
   "metadata": {},
   "outputs": [],
   "source": [
    "df.to_csv(\"Data_Etherscan_scrapping_USDC.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "be16b0b7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>Txn_Hash</th>\n",
       "      <th>Age</th>\n",
       "      <th>From</th>\n",
       "      <th>IN_or_OUT</th>\n",
       "      <th>To</th>\n",
       "      <th>Value</th>\n",
       "      <th>Token</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>0x2921c93dfdf53dfcd72fe1cb7b6acc1d0fcacb80b42b...</td>\n",
       "      <td>2 mins ago</td>\n",
       "      <td>zeroxignacio.eth</td>\n",
       "      <td>IN</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>163651.588590</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>0x88e9c3576be6d803b7fbf95a83a163824202c3f08bcb...</td>\n",
       "      <td>5 mins ago</td>\n",
       "      <td>0xf2f400c138f9fb900576263af0bc7fcde2b1b8a8</td>\n",
       "      <td>IN</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>32475.826065</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>0xb1eb11bdc6358b1a41ac07c00fee031cb82425159a3a...</td>\n",
       "      <td>13 mins ago</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>OUT</td>\n",
       "      <td>goldensperm.eth</td>\n",
       "      <td>0.103456</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>0xde6d8acf9ddacf5ab1bf9960724af7d4df62001d00f6...</td>\n",
       "      <td>13 mins ago</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>OUT</td>\n",
       "      <td>horizonzerodawn.eth</td>\n",
       "      <td>0.055000</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>0x4c7ac11ff4ef6b6d8834ab068890276d2e9dc10f6d46...</td>\n",
       "      <td>15 mins ago</td>\n",
       "      <td>0xeec1e0f055af1f45ac67400b7c706494651c3a53</td>\n",
       "      <td>IN</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>2.488251</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9795</th>\n",
       "      <td>9795</td>\n",
       "      <td>0x1c1784c72915cad03af2cf1e1c2bdd5f1df88599630c...</td>\n",
       "      <td>28 days 21 hrs ago</td>\n",
       "      <td>0xd3df502ae3e5db05b5dd8a744417a5ad51c11f9b</td>\n",
       "      <td>IN</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>2000.000000</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9796</th>\n",
       "      <td>9796</td>\n",
       "      <td>0xe8c82b5ff9a493434d74f04722558461f89d057c847b...</td>\n",
       "      <td>28 days 21 hrs ago</td>\n",
       "      <td>MEV Bot: 0x9A0...832</td>\n",
       "      <td>IN</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>169.226442</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9797</th>\n",
       "      <td>9797</td>\n",
       "      <td>0xd8a523fb06197c2f349c68c312b9910841820da5afbc...</td>\n",
       "      <td>28 days 21 hrs ago</td>\n",
       "      <td>MEV Bot: 0x847...2d2</td>\n",
       "      <td>IN</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>210.153261</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9798</th>\n",
       "      <td>9798</td>\n",
       "      <td>0xfec853a12b17374a84d5dbcf0d3a6be882ae2cb69106...</td>\n",
       "      <td>28 days 21 hrs ago</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>OUT</td>\n",
       "      <td>0xea7ed1807c1a18bcbef9c20624a3aa05a9f0b50c</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9799</th>\n",
       "      <td>9799</td>\n",
       "      <td>0xedde5ab0c3d877fee5e705c4e740c13a218e75e586ee...</td>\n",
       "      <td>28 days 21 hrs ago</td>\n",
       "      <td>MEV Bot: 0x9A0...832</td>\n",
       "      <td>IN</td>\n",
       "      <td>Aave: aUSDC Token V2</td>\n",
       "      <td>170.599683</td>\n",
       "      <td>USD Coin (USDC)</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>9800 rows Ã— 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Unnamed: 0                                           Txn_Hash  \\\n",
       "0              0  0x2921c93dfdf53dfcd72fe1cb7b6acc1d0fcacb80b42b...   \n",
       "1              1  0x88e9c3576be6d803b7fbf95a83a163824202c3f08bcb...   \n",
       "2              2  0xb1eb11bdc6358b1a41ac07c00fee031cb82425159a3a...   \n",
       "3              3  0xde6d8acf9ddacf5ab1bf9960724af7d4df62001d00f6...   \n",
       "4              4  0x4c7ac11ff4ef6b6d8834ab068890276d2e9dc10f6d46...   \n",
       "...          ...                                                ...   \n",
       "9795        9795  0x1c1784c72915cad03af2cf1e1c2bdd5f1df88599630c...   \n",
       "9796        9796  0xe8c82b5ff9a493434d74f04722558461f89d057c847b...   \n",
       "9797        9797  0xd8a523fb06197c2f349c68c312b9910841820da5afbc...   \n",
       "9798        9798  0xfec853a12b17374a84d5dbcf0d3a6be882ae2cb69106...   \n",
       "9799        9799  0xedde5ab0c3d877fee5e705c4e740c13a218e75e586ee...   \n",
       "\n",
       "                     Age                                        From  \\\n",
       "0             2 mins ago                            zeroxignacio.eth   \n",
       "1             5 mins ago  0xf2f400c138f9fb900576263af0bc7fcde2b1b8a8   \n",
       "2            13 mins ago                        Aave: aUSDC Token V2   \n",
       "3            13 mins ago                        Aave: aUSDC Token V2   \n",
       "4            15 mins ago  0xeec1e0f055af1f45ac67400b7c706494651c3a53   \n",
       "...                  ...                                         ...   \n",
       "9795  28 days 21 hrs ago  0xd3df502ae3e5db05b5dd8a744417a5ad51c11f9b   \n",
       "9796  28 days 21 hrs ago                        MEV Bot: 0x9A0...832   \n",
       "9797  28 days 21 hrs ago                        MEV Bot: 0x847...2d2   \n",
       "9798  28 days 21 hrs ago                        Aave: aUSDC Token V2   \n",
       "9799  28 days 21 hrs ago                        MEV Bot: 0x9A0...832   \n",
       "\n",
       "     IN_or_OUT                                          To          Value  \\\n",
       "0           IN                        Aave: aUSDC Token V2  163651.588590   \n",
       "1           IN                        Aave: aUSDC Token V2   32475.826065   \n",
       "2          OUT                             goldensperm.eth       0.103456   \n",
       "3          OUT                         horizonzerodawn.eth       0.055000   \n",
       "4           IN                        Aave: aUSDC Token V2       2.488251   \n",
       "...        ...                                         ...            ...   \n",
       "9795        IN                        Aave: aUSDC Token V2    2000.000000   \n",
       "9796        IN                        Aave: aUSDC Token V2     169.226442   \n",
       "9797        IN                        Aave: aUSDC Token V2     210.153261   \n",
       "9798       OUT  0xea7ed1807c1a18bcbef9c20624a3aa05a9f0b50c       2.000000   \n",
       "9799        IN                        Aave: aUSDC Token V2     170.599683   \n",
       "\n",
       "                Token  \n",
       "0     USD Coin (USDC)  \n",
       "1     USD Coin (USDC)  \n",
       "2     USD Coin (USDC)  \n",
       "3     USD Coin (USDC)  \n",
       "4     USD Coin (USDC)  \n",
       "...               ...  \n",
       "9795  USD Coin (USDC)  \n",
       "9796  USD Coin (USDC)  \n",
       "9797  USD Coin (USDC)  \n",
       "9798  USD Coin (USDC)  \n",
       "9799  USD Coin (USDC)  \n",
       "\n",
       "[9800 rows x 8 columns]"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dfbc = pd.read_csv(\"Data_Etherscan_scrapping_USDC.csv\")\n",
    "dfbc"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9ff14fb9",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
